{% extends "base.html" %}

{% block content %}
<h2>Manage Albums</h2>
<form method="post" action="{% url 'create_album' %}">
  {% csrf_token %}
  <label for="title">Title:</label>
  <input type="text" id="title" name="title"><br>
  <label for="label">Label:</label>
  <select id="label" name="label">
    {% for label in labels %}
      <option value="{{ label.id }}">{{ label.nama }}</option>
    {% endfor %}
  </select>
  <input type="submit" value="Create Album">
</form>

<!-- List of albums -->
{% for album in albums %}
  <div>
    <h3>{{ album.title }} by {{ album.label.nama }}</h3>
    <p>{{ album.songs.count }} songs, {{ album.total_duration }} minutes</p>
    <a href="{% url 'add_song_to_album' album.id %}">Add Song</a>
    <a href="{% url 'delete_album' album.id %}">Delete</a>
  </div>
{% endfor %}

<h2>Add Song to Album</h2>
<form method="post" action="{% url 'create_song' %}">
  {% csrf_token %}
  <input type="hidden" name="album_id" value="{{ album_id }}">
  
  <label for="title">Title:</label>
  <input type="text" id="title" name="title"><br>
  
  <label for="artist">Artist:</label>
  {% if user.is_artist %}
    <input type="text" id="artist" name="artist" value="{{ user.artist.name }}" readonly><br>
  {% else %}
    <select id="artist" name="artist">
      {% for artist in artists %}
        <option value="{{ artist.id }}">{{ artist.name }}</option>
      {% endfor %}
    </select><br>
  {% endif %}
  
  <label for="songwriters">Songwriter:</label>
  <select id="songwriters" name="songwriters" multiple>
    {% for songwriter in songwriters %}
      <option value="{{ songwriter.id }}">{{ songwriter.name }}</option>
    {% endfor %}
  </select><br>
  
  <label for="genres">Genre:</label>
  <select id="genres" name="genres" multiple>
    {% for genre in genres %}
      <option value="{{ genre.id }}">{{ genre.name }}</option>
    {% endfor %}
  </select><br>
  
  <label for="duration">Duration:</label>
  <input type="text" id="duration" name="duration"><br>
  
  <input type="submit" value="Create Song">
</form>

<!-- List of songs in an album -->
<h3>Songs in Album: {{ album_title }}</h3>
{% for song in songs %}
  <div>
    <p>{{ song.title }} - {{ song.duration }} minutes</p>
    <a href="{% url 'delete_song' song.id %}">Delete</a>
  </div>
{% endfor %}
{% endblock %}